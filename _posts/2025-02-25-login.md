---
description: >-
  Writeup del laboratorio de dificultad media Login de la página https://bugbountylabs.com/
title: BBLabs - Login | (Difficulty Medium) - XSS
date: 2025-02-25
categories: [Writeup, Bug Bounty Labs]
tags: [bblabs, hacking, bug bounty labs, hacking web, xss, easy, writeup, pentesting]
image_post: true
image: https://github.com/user-attachments/assets/2557e8da-1215-4c0e-a8ad-d91a74dcd99b

---

## TCP Scan

Realizo un escaneo de puertos TCP contra la dirección IP 172.17.0.2 pudiendo observar cuatros puertos, **`80, 5050, 8080, 9090`**, los cuatro puertos alojan un servidor web HTTP Apache/2.4.62

```bash
rustscan -a 172.17.0.2 --ulimit 5000 -g
172.17.0.2 -> [80,5050,8080,9090]
```

```bash
nmap -p80,5050,8080,9090 -sCV 172.17.0.2
Starting Nmap 7.95 ( https://nmap.org ) at 2025-02-25 19:54 CET
Nmap scan report for 172.17.0.2 (172.17.0.2)
Host is up (0.000022s latency).

PORT     STATE SERVICE VERSION
80/tcp   open  http    Apache httpd 2.4.62 ((Debian))
|_http-title: Login Form
|_http-server-header: Apache/2.4.62 (Debian)
5050/tcp open  http    Apache httpd 2.4.62 ((Debian))
|_http-title: Dark Theme Login
|_http-server-header: Apache/2.4.62 (Debian)
8080/tcp open  http    Apache httpd 2.4.62 ((Debian))
|_http-title: Login Page
|_http-server-header: Apache/2.4.62 (Debian)
|_http-open-proxy: Proxy might be redirecting requests
9090/tcp open  http    Apache httpd 2.4.62 ((Debian))
|_http-title: Login Page
|_http-server-header: Apache/2.4.62 (Debian)
MAC Address: 02:42:AC:11:00:02 (Unknown)

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 31.42 seconds
```

## Exploitation

### 80/TCP

Accedo a http://172.17.0.2/ puediendo observar un formulario de login

![image](https://github.com/user-attachments/assets/226475f6-72c5-4dcc-871c-e39da54a84f1)

Introduzco una credenciales inválidas para comprobar el comportamiento de la web, pudiendo observar que el mensaje de error se maneja a través de un parámetro GET en la URL llamado **`?error=`** donde se utiliza la etiqueta HTML **`<b>`**

![image](https://github.com/user-attachments/assets/96b0c318-99e5-4c76-8741-2f2b904c527d)

![image](https://github.com/user-attachments/assets/8d2e498b-557b-441f-963b-86c9d8fb1dc7)

![image](https://github.com/user-attachments/assets/933023c2-c79f-42f4-a178-04900d377e9d)

#### HTML Injection

Intento inyectar una etiqueta HTML diferente a **`<b>`**, por ejemplo, un título **`<h1>`** de forma sencilla, puediendo ver que soy capaz de alterar el texto y hacer que sea un titulo, consiguiendo realizar el HTML Injection de forma satisfactoria.

##### Payload

```
/?error=<h1>HTML+Injection<%2Fh1>
```

![image](https://github.com/user-attachments/assets/b5c2ca3c-24c7-4d7a-bf60-be7d9d38749f)

![image](https://github.com/user-attachments/assets/361b5d1f-fc65-4843-8722-9d2fe81d2df1)

![image](https://github.com/user-attachments/assets/968c0395-f870-4e47-9edf-4d608f3157d0)

#### Reflected XSS

Pudiendo haber realizar una inyección de código HTML lo suyo sería intentar inyectar código JavaScript, utilizando la etiqueta **`<script>`** no funciona, por lo que una alternativa de tantas es utilizar la etiqueta **`<img>`** y apuntar a una imagen inexistente, luego por ultimo indicar que cuando se produzca un error se ejecute el código JavaScript que deseemos.

##### Payload

```html
<img src=x onerror=alert('xss')>
```

![image](https://github.com/user-attachments/assets/73e08231-d1b7-49ef-9808-06f54e987618)

![image](https://github.com/user-attachments/assets/3c5cde3a-e724-4964-83b3-8d665401317f)

![image](https://github.com/user-attachments/assets/0e0dcd4d-12c4-45d3-8077-ced4ef4eb0ef)
