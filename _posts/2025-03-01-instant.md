---
description: >-
  Writeup de la máquina de dificultad media Instant de la página https://hackthebox.eu
title: HTB - Instant | (Difficulty Medium) - Linux
date: 2025-03-01
categories: [Writeup, Hack the Box]
tags: [htb, hacking, hack the box, linux, apktool, medium, writeup, redteam, pentesting]
image_post: true
image: https://github.com/user-attachments/assets/67468f2f-4cbe-42b2-8858-31c4815edee2
---

## Useful Skills

* Web enumeration
* APK analysis
* Information lekeage
* LFI through 

## Enumeration

### TCP Scan

 ```bash
rustscan -a 10.10.11.37 --ulimit 5000 -g
10.10.11.37 -> [22,80]
```

```bash
nmap -p22,80 -sCV 10.10.11.37 -oN tcpScan
Starting Nmap 7.95 ( https://nmap.org ) at 2025-03-02 09:51 CET
Nmap scan report for 10.10.11.37 (10.10.11.37)
Host is up (0.035s latency).

PORT   STATE SERVICE VERSION
22/tcp open  ssh     OpenSSH 9.6p1 Ubuntu 3ubuntu13.5 (Ubuntu Linux; protocol 2.0)
| ssh-hostkey: 
|   256 31:83:eb:9f:15:f8:40:a5:04:9c:cb:3f:f6:ec:49:76 (ECDSA)
|_  256 6f:66:03:47:0e:8a:e0:03:97:67:5b:41:cf:e2:c7:c7 (ED25519)
80/tcp open  http    Apache httpd 2.4.58
|_http-title: Did not follow redirect to http://instant.htb/
|_http-server-header: Apache/2.4.58 (Ubuntu)
Service Info: Host: instant.htb; OS: Linux; CPE: cpe:/o:linux:linux_kernel

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 7.74 seconds
```

### UDP Scan

 ```bash
nmap -sU --top-ports 1500 --min-rate 5000 -n -Pn 10.10.11.37 -oN udpScan
Starting Nmap 7.95 ( https://nmap.org ) at 2025-03-02 09:52 CET
Nmap scan report for 10.10.11.37
Host is up (0.32s latency).
Not shown: 1494 open|filtered udp ports (no-response)
PORT      STATE  SERVICE
17338/udp closed unknown
17787/udp closed unknown
18617/udp closed unknown
19273/udp closed unknown
23073/udp closed unknown
33866/udp closed unknown

Nmap done: 1 IP address (1 host up) scanned in 1.62 seconds
```

> Hay que añadir el dominio instant.htb en el archivo de configuración /etc/hosts para que se pueda resolver el nombre de dominio a la dirección IP 10.10.11.37
{: .prompt-tip }

### HTTP Enumeration

Whatweb reporta un servidor Apache 2.4.58 y una version de Jquery desactualizada

```bash
whatweb http://instant.htb
http://instant.htb [200 OK] Apache[2.4.58], Bootstrap[4.0.0], Country[RESERVED][ZZ], Email[support@instant.htb], HTML5, HTTPServer[Ubuntu Linux][Apache/2.4.58 (Ubuntu)], IP[10.10.11.37], JQuery[3.2.1], Script, Title[Instant Wallet]
```

Accediendo a la página en http://instant.htb/ puedo observar una página web dedicada al envío de transacciones de dinero, al hacer clic sobre "Download now" se descarga una APK llamada instant.apk

![image](https://github.com/user-attachments/assets/503fe436-1d66-4596-8383-5016c844cb1b)

## Exploitation

Una vez he descargado la APK, utilizo la herramienta apktool para extraer y descompilar los recursos de la aplicación y poder analizarla

```bash
apktool d instant.apk
I: Using Apktool 2.7.0-dirty on instant.apk
I: Loading resource table...
I: Decoding AndroidManifest.xml with resources...
I: Loading resource table from file: /root/.local/share/apktool/framework/1.apk
I: Regular manifest package...
I: Decoding file-resources...
I: Decoding values */* XMLs...
I: Baksmaling classes.dex...
I: Copying assets and libs...
I: Copying unknown files...
I: Copying original files...
I: Copying META-INF/services directory
```

