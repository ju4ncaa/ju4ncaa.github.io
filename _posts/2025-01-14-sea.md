---
description: >-
  Writeup de la máquina de dificultad fácil Sea de la página https://hackthebox.eu
title: Hack The Box - Sea | (Difficulty Easy) - Linux
date: 2025-01-14 00:00:00 +0800
categories: [Hack the Box, Writeup]
tags: [htb, hacking, hack the box, linux, easy, writeup, redteam, pentesting]
image_post: true
image: https://github.com/user-attachments/assets/d5427b54-df60-419a-8e4d-416a4e013c13
---

## Useful Skills

* Web enumeration
* Abusing XSS to RCE (WonderCMS 3.2.0 - CVE-2023-41425)
* 
  
## Enumeration

### TCP Scan

 ```bash
rustscan -a 10.10.11.28 --ulimit 5000 -g
10.10.11.28 -> [22,80]
```

```bash
nmap -p22,80 -sCV 10.10.11.28 -oN tcpScan
Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-01-14 21:37 CET
Nmap scan report for 10.10.11.28
Host is up (0.041s latency).

PORT   STATE SERVICE VERSION
22/tcp open  ssh     OpenSSH 8.2p1 Ubuntu 4ubuntu0.11 (Ubuntu Linux; protocol 2.0)
| ssh-hostkey: 
|   3072 e3:54:e0:72:20:3c:01:42:93:d1:66:9d:90:0c:ab:e8 (RSA)
|   256 f3:24:4b:08:aa:51:9d:56:15:3d:67:56:74:7c:20:38 (ECDSA)
|_  256 30:b1:05:c6:41:50:ff:22:a3:7f:41:06:0e:67:fd:50 (ED25519)
80/tcp open  http    Apache httpd 2.4.41 ((Ubuntu))
| http-cookie-flags: 
|   /: 
|     PHPSESSID: 
|_      httponly flag not set
|_http-title: Sea - Home
|_http-server-header: Apache/2.4.41 (Ubuntu)
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 8.99 seconds
```

### UDP Scan

 ```bash
nmap -sU --top-ports 1500 --min-rate 5000 -n -Pn 10.10.11.28 -oN udpScan
Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-01-14 21:40 CET
Nmap scan report for 10.10.11.28
Host is up (0.041s latency).
Not shown: 1494 open|filtered udp ports (no-response)
PORT      STATE  SERVICE
515/udp   closed printer
1000/udp  closed ock
1234/udp  closed search-agent
25003/udp closed icl-twobase4
33459/udp closed unknown
49193/udp closed unknown
```

### HTTP Enumeration

Whatweb reporta que una cookie PHPSESSID y una versión de JQuery desactualizada.

```bash
whatweb http://10.10.11.28
http://10.10.11.28 [200 OK] Apache[2.4.41], Bootstrap[3.3.7], Cookies[PHPSESSID], Country[RESERVED][ZZ], HTML5, HTTPServer[Ubuntu Linux][Apache/2.4.41 (Ubuntu)], IP[10.10.11.28], JQuery[1.12.4], Script, Title[Sea - Home], X-UA-Compatible[IE=edge]
```

Accediendo a la página en ``http://10.10.11.28`` se puede observar una web de una empresa que organiza competiciones en bicicleta.

![imagen](https://github.com/user-attachments/assets/521beec3-873a-44fd-93d0-615f44970f3e)

Existe una opción en el navbar para obtener información de como participar, se indica que hay que enviar lo datos a través de un formulario de contacto y se adjunta el enlace hacia el mismo.

![imagen](https://github.com/user-attachments/assets/4268b7eb-3d63-4137-b3fe-d79e0a5dd327)

Intento acceder al formulario de contacto pero el servidor me responde con que no se puede acceder a sea.htb, si reviso la URL y el codigo fuente se puede ver que se intenta redirigir hacia sea.htb. 

![imagen](https://github.com/user-attachments/assets/dc704405-bf68-4359-88ee-1842ddeb3baf)

![imagen](https://github.com/user-attachments/assets/d0b879a4-a3d9-463c-bace-e64ee516bdb4)

> Hay que añadir el dominio sea.htb en el archivo de configuración /etc/hosts para que se puede resolver el nombre de dominio a la dirección IP 10.10.11.28
{: .prompt-tip }

Intento acceder de nuevo y relleno los datos del formulario y acto seguido lo envío, pero de momento no encuentro niguna cosa interesante.

![imagen](https://github.com/user-attachments/assets/2e491747-8f19-4318-90f4-51982cc14b86)

![imagen](https://github.com/user-attachments/assets/4514f89c-10e0-4d3b-abd7-b09e23a72449)

Utilizo gobuster para realizar enumeración de directorios exhaustiva

```bash
gobuster dir -u http://10.10.11.28 -w /usr/share/seclists/Discovery/Web-Content/raft-medium-words.txt -t 100 -b404,403 -q
/plugins              (Status: 301) [Size: 235] [--> http://10.10.11.28/plugins/]
/themes               (Status: 301) [Size: 234] [--> http://10.10.11.28/themes/]
/data                 (Status: 301) [Size: 232] [--> http://10.10.11.28/data/]
/404                  (Status: 200) [Size: 3361]
/home                 (Status: 200) [Size: 3670]
/.                    (Status: 200) [Size: 3670]
/messages             (Status: 301) [Size: 236] [--> http://10.10.11.28/messages/]
/0                    (Status: 200) [Size: 3670]
```

```bash
gobuster dir -u http://10.10.11.28/plugins -w /usr/share/seclists/Discovery/Web-Content/raft-medium-words.txt -t 200 -b403,404 -q
/home                 (Status: 200) [Size: 3670]
/404                  (Status: 200) [Size: 3361]
```

```bash
gobuster dir -u http://10.10.11.28/themes -w /usr/share/seclists/Discovery/Web-Content/raft-medium-words.txt -t 200 -b403,404 -q
/home                 (Status: 200) [Size: 3670]
/404                  (Status: 200) [Size: 3361]
/bike                 (Status: 301) [Size: 239] [--> http://10.10.11.28/themes/bike/]
```

```bash
gobuster dir -u http://10.10.11.28/themes/bike -w /usr/share/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt -t 200 -b403,404 -q
/home                 (Status: 200) [Size: 3670]
/version              (Status: 200) [Size: 6]
/css                  (Status: 301) [Size: 243] [--> http://10.10.11.28/themes/bike/css/]
/summary              (Status: 200) [Size: 66]
/404                  (Status: 200) [Size: 3361]
/LICENSE              (Status: 200) [Size: 1067
```

> En los escaneos obtengo dos recursos que me parecen muy interesantes, uno es /version donde puede que exista información sobre versiones, y por otro lado LICENSE que es un archivo que no se suele ver en directorios y que lo asocio a repositorios de GitHub.
{: .prompt-note }

Accedo a /themes/bike/version y puedo observar un número de version el cual es 3.2.0, pero nose a que se asocia dicha versión.

![imagen](https://github.com/user-attachments/assets/7643ad0b-fe6e-4d28-8bcc-8112416a8e5d)

Accedo a /themes/bike/LICENSE y puedo observar una licencia MIT que hace referencia a un usuario llamado turboblack

![imagen](https://github.com/user-attachments/assets/5e2c2bfd-98e3-4123-8d9b-b8bd16562c93)

Podría dirigirme a github y buscar el usuario turboblack, pero antes que nada supongo que si hay un archivo LICENSE deberá de existir un archivo README.md

![imagen](https://github.com/user-attachments/assets/4012b4b5-08d7-45da-9235-f9e92d2e90d3)

> Sabiendo que es WonderCMS y que la versión es 3.2.0 puedo buscar información sobre posibles vulnerabilidades existentes
{: .prompt-note }

## Vulnerability analysis

### CVE-2023-41425 (WonderCMS Remote Code Execution)

Una pequeña búsqueda en internet me permite dar con la vulnerabilidad CVE-2023-41425, se trata de un Cross-Site-Scripting que permite a un atacante ejecutar código arbitrario a través de un script malicioso cargado en el componente installModule.

> La vulnerabilidad CVE-2023-41425 abarca desde WonderCMS v.3.2.0 hasta v.3.4.2
{: .prompt-note }

* [NVD Explanation CVE-2023-41425](https://nvd.nist.gov/vuln/detail/CVE-2023-41425)

## Exploitation

### Abusing WonderCMS RCE Vulnerability (CVE-2023-41425)

En GitHub encuentro dos repositorio sobre la vulnerabilidad CVE-2023-41425 los cuales me sirven de guía para realizar la explotación de forma manual y entender como funciona todo.

* [CVE-2023-41425 Public Disclosure](https://gist.github.com/prodigiousMind/fc69a79629c4ba9ee88a7ad526043413)
* [CVE-2023-41425](https://github.com/duck-sec/CVE-2023-41425)

![imagen](https://github.com/user-attachments/assets/c9f1f9bc-239f-47c5-9671-ccf235d5fd31)

![imagen](https://github.com/user-attachments/assets/94691bdc-b708-470d-966e-2a04239fe728)

> Se necesita la URL donde WonderCMS está instalado y crear un archivo xss.js el cual ya se proporciona en el repositorio de GitHub
{: .prompt-note }

Analizando el exploit de Python encuentro que WonderCMS se encuentra instalado en http://sea.htb/loginURL

![imagen](https://github.com/user-attachments/assets/c6b7acb8-2036-4111-928e-85f65b68b5eb)

